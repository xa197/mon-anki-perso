{"ast":null,"code":"import React,{useState}from'react';// ON REÇOIT DE NOUVELLES PROPS : onSetQuiz et onSetLoading\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function LibraryView(_ref){let{navigateTo,allCards,itemsData,onSetQuiz,onSetLoading}=_ref;const[selectedItem,setSelectedItem]=useState('');const[numQCM,setNumQCM]=useState(3);const[numQRU,setNumQRU]=useState(2);const sortedItems=Array.from(new Set(allCards.map(c=>c.deck).filter(Boolean))).sort((a,b)=>parseInt(a.split(':')[0],10)-parseInt(b.split(':')[0],10));sortedItems.unshift(\"500: Divers\");const handleGenerateQuiz=async()=>{if(!selectedItem||!itemsData[selectedItem])return;onSetLoading(true);// On dit à App.js d'afficher un spinner\nnavigateTo('quiz');// On navigue vers la page de quiz immédiatement\ntry{const response=await fetch('/api/generate-questions',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:itemsData[selectedItem],numQCM,numQRU})});if(!response.ok)throw new Error('Erreur de l\\'API');const quizData=await response.json();onSetQuiz(quizData.questions);// On envoie les questions à App.js\n}catch(error){console.error(\"Erreur lors de la génération du quiz:\",error);onSetQuiz([]);// En cas d'erreur, on envoie un quiz vide\n}finally{onSetLoading(false);// On dit à App.js de cacher le spinner\n}};return/*#__PURE__*/_jsxs(\"div\",{id:\"library-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"library-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('home'),children:\"\\u2190 Accueil\"}),/*#__PURE__*/_jsx(\"div\",{className:\"library-selector-container\",children:/*#__PURE__*/_jsxs(\"select\",{value:selectedItem,onChange:e=>setSelectedItem(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Choisir un item --\"}),sortedItems.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item,children:item},item))]})})]}),/*#__PURE__*/_jsx(\"div\",{id:\"library-content-display\",children:selectedItem?/*#__PURE__*/_jsx(\"p\",{children:itemsData[selectedItem]||'Aucune note.'}):/*#__PURE__*/_jsx(\"p\",{children:\"Veuillez s\\xE9lectionner un item.\"})}),selectedItem&&itemsData[selectedItem]&&/*#__PURE__*/_jsxs(\"div\",{className:\"generation-options\",style:{display:'flex',gap:'10px',margin:'20px 0'},children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"QCM : \",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:numQCM,onChange:e=>setNumQCM(parseInt(e.target.value)),style:{width:'60px'}})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"QRU : \",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:numQRU,onChange:e=>setNumQRU(parseInt(e.target.value)),style:{width:'60px'}})]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"library-actions-container\",children:selectedItem&&itemsData[selectedItem]&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"ia-btn\",onClick:handleGenerateQuiz,children:\"S'entra\\xEEner (Quiz IA)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ia-btn success\",children:\"Cr\\xE9er des cartes (IA)\"})]})})]});}export default LibraryView;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LibraryView","_ref","navigateTo","allCards","itemsData","onSetQuiz","onSetLoading","selectedItem","setSelectedItem","numQCM","setNumQCM","numQRU","setNumQRU","sortedItems","Array","from","Set","map","c","deck","filter","Boolean","sort","a","b","parseInt","split","unshift","handleGenerateQuiz","response","fetch","method","headers","body","JSON","stringify","text","ok","Error","quizData","json","questions","error","console","id","children","className","onClick","value","onChange","e","target","item","style","display","gap","margin","type","min","width"],"sources":["/Users/xavier/mon-anki-perso/src/components/LibraryView.js"],"sourcesContent":["import React, { useState } from 'react';\n\n// ON REÇOIT DE NOUVELLES PROPS : onSetQuiz et onSetLoading\nfunction LibraryView({ navigateTo, allCards, itemsData, onSetQuiz, onSetLoading }) {\n  const [selectedItem, setSelectedItem] = useState('');\n  const [numQCM, setNumQCM] = useState(3);\n  const [numQRU, setNumQRU] = useState(2);\n\n  const sortedItems = Array.from(new Set(allCards.map(c => c.deck).filter(Boolean)))\n    .sort((a, b) => parseInt(a.split(':')[0], 10) - parseInt(b.split(':')[0], 10));\n  sortedItems.unshift(\"500: Divers\");\n\n  const handleGenerateQuiz = async () => {\n    if (!selectedItem || !itemsData[selectedItem]) return;\n    \n    onSetLoading(true); // On dit à App.js d'afficher un spinner\n    navigateTo('quiz'); // On navigue vers la page de quiz immédiatement\n\n    try {\n      const response = await fetch('/api/generate-questions', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ \n          text: itemsData[selectedItem],\n          numQCM,\n          numQRU \n        })\n      });\n\n      if (!response.ok) throw new Error('Erreur de l\\'API');\n      \n      const quizData = await response.json();\n      onSetQuiz(quizData.questions); // On envoie les questions à App.js\n      \n    } catch (error) {\n      console.error(\"Erreur lors de la génération du quiz:\", error);\n      onSetQuiz([]); // En cas d'erreur, on envoie un quiz vide\n    } finally {\n      onSetLoading(false); // On dit à App.js de cacher le spinner\n    }\n  };\n\n  return (\n    <div id=\"library-view\">\n        {/* ... (le header et le content display ne changent pas) ... */}\n        <div className=\"library-header\">\n            <button onClick={() => navigateTo('home')}>← Accueil</button>\n            <div className=\"library-selector-container\">\n              <select value={selectedItem} onChange={e => setSelectedItem(e.target.value)}>\n                <option value=\"\">-- Choisir un item --</option>\n                {sortedItems.map(item => (<option key={item} value={item}>{item}</option>))}\n              </select>\n            </div>\n        </div>\n        <div id=\"library-content-display\">\n            {selectedItem ? (<p>{itemsData[selectedItem] || 'Aucune note.'}</p>) : (<p>Veuillez sélectionner un item.</p>)}\n        </div>\n      \n      {selectedItem && itemsData[selectedItem] && (\n        <div className=\"generation-options\" style={{ display: 'flex', gap: '10px', margin: '20px 0' }}>\n          <label>QCM : <input type=\"number\" min=\"0\" value={numQCM} onChange={e => setNumQCM(parseInt(e.target.value))} style={{width: '60px'}} /></label>\n          <label>QRU : <input type=\"number\" min=\"0\" value={numQRU} onChange={e => setNumQRU(parseInt(e.target.value))} style={{width: '60px'}} /></label>\n        </div>\n      )}\n\n      <div id=\"library-actions-container\">\n        {selectedItem && itemsData[selectedItem] && (\n          <>\n            <button className=\"ia-btn\" onClick={handleGenerateQuiz}>S'entraîner (Quiz IA)</button>\n            <button className=\"ia-btn success\">Créer des cartes (IA)</button>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default LibraryView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}