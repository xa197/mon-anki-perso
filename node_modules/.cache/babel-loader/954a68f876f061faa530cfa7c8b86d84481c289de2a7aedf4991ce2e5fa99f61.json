{"ast":null,"code":"import React,{useState}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function LibraryView(_ref){let{navigateTo,allCards,itemsData,onStartQuiz,onSetLoading,onGenerateCards}=_ref;const[selectedItem,setSelectedItem]=useState('');const[numQCM,setNumQCM]=useState(3);const[numQRU,setNumQRU]=useState(2);const sortedItems=Array.from(new Set(allCards.map(c=>c.deck).filter(Boolean))).sort((a,b)=>parseInt(a.split(':')[0],10)-parseInt(b.split(':')[0],10));sortedItems.unshift(\"500: Divers\");const handleGenerateQuiz=async()=>{if(!selectedItem||!itemsData[selectedItem])return;onSetLoading(true);try{const response=await fetch('/api/generate-questions',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:itemsData[selectedItem],numQCM,numQRU})});if(!response.ok)throw new Error('Erreur API');const quizData=await response.json();onStartQuiz(quizData.questions,selectedItem);}catch(error){console.error(\"Erreur génération quiz:\",error);onStartQuiz([],selectedItem);}finally{onSetLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{id:\"library-view\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"library-header\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('home'),children:\"\\u2190 Accueil\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"library-selector-container\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"library-item-selector\",children:\"Consulter l'item :\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"library-item-selector\",value:selectedItem,onChange:e=>setSelectedItem(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Choisir un item --\"}),sortedItems.map(item=>/*#__PURE__*/_jsx(\"option\",{value:item,children:item},item))]})]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"library-content-display\",children:selectedItem?/*#__PURE__*/_jsx(\"p\",{children:itemsData[selectedItem]||'Aucune note enregistrée pour cet item.'}):/*#__PURE__*/_jsx(\"p\",{className:\"placeholder-text\",children:\"Veuillez s\\xE9lectionner un item.\"})}),selectedItem&&itemsData[selectedItem]&&/*#__PURE__*/_jsxs(\"div\",{className:\"generation-options\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[\"QCM : \",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:numQCM,onChange:e=>setNumQCM(parseInt(e.target.value))})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"QRU : \",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:numQRU,onChange:e=>setNumQRU(parseInt(e.target.value))})]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"library-actions-container\",children:selectedItem&&itemsData[selectedItem]&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"ia-btn\",onClick:handleGenerateQuiz,children:\"S'entra\\xEEner (Quiz IA)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ia-btn success\",onClick:()=>onGenerateCards(selectedItem,itemsData[selectedItem]),children:\"Cr\\xE9er des cartes (IA)\"})]})})]});}export default LibraryView;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LibraryView","_ref","navigateTo","allCards","itemsData","onStartQuiz","onSetLoading","onGenerateCards","selectedItem","setSelectedItem","numQCM","setNumQCM","numQRU","setNumQRU","sortedItems","Array","from","Set","map","c","deck","filter","Boolean","sort","a","b","parseInt","split","unshift","handleGenerateQuiz","response","fetch","method","headers","body","JSON","stringify","text","ok","Error","quizData","json","questions","error","console","id","children","className","onClick","htmlFor","value","onChange","e","target","item","type","min"],"sources":["/Users/xavier/mon-anki-perso/src/components/LibraryView.js"],"sourcesContent":["import React, { useState } from 'react';\n\nfunction LibraryView({ navigateTo, allCards, itemsData, onStartQuiz, onSetLoading, onGenerateCards }) {\n  const [selectedItem, setSelectedItem] = useState('');\n  const [numQCM, setNumQCM] = useState(3);\n  const [numQRU, setNumQRU] = useState(2);\n\n  const sortedItems = Array.from(new Set(allCards.map(c => c.deck).filter(Boolean)))\n    .sort((a, b) => parseInt(a.split(':')[0], 10) - parseInt(b.split(':')[0], 10));\n  sortedItems.unshift(\"500: Divers\");\n\n  const handleGenerateQuiz = async () => {\n    if (!selectedItem || !itemsData[selectedItem]) return;\n    onSetLoading(true);\n    try {\n      const response = await fetch('/api/generate-questions', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ text: itemsData[selectedItem], numQCM, numQRU })\n      });\n      if (!response.ok) throw new Error('Erreur API');\n      const quizData = await response.json();\n      onStartQuiz(quizData.questions, selectedItem);\n    } catch (error) {\n      console.error(\"Erreur génération quiz:\", error);\n      onStartQuiz([], selectedItem);\n    } finally {\n      onSetLoading(false);\n    }\n  };\n\n  return (\n    <div id=\"library-view\">\n      <div className=\"library-header\">\n        <button onClick={() => navigateTo('home')}>← Accueil</button>\n        <div className=\"library-selector-container\">\n          <label htmlFor=\"library-item-selector\">Consulter l'item :</label>\n          <select id=\"library-item-selector\" value={selectedItem} onChange={e => setSelectedItem(e.target.value)}>\n            <option value=\"\">-- Choisir un item --</option>\n            {sortedItems.map(item => (<option key={item} value={item}>{item}</option>))}\n          </select>\n        </div>\n      </div>\n      <div id=\"library-content-display\">\n        {selectedItem ? (<p>{itemsData[selectedItem] || 'Aucune note enregistrée pour cet item.'}</p>) : (<p className=\"placeholder-text\">Veuillez sélectionner un item.</p>)}\n      </div>\n      {selectedItem && itemsData[selectedItem] && (\n        <div className=\"generation-options\">\n          <label>QCM : <input type=\"number\" min=\"0\" value={numQCM} onChange={e => setNumQCM(parseInt(e.target.value))} /></label>\n          <label>QRU : <input type=\"number\" min=\"0\" value={numQRU} onChange={e => setNumQRU(parseInt(e.target.value))} /></label>\n        </div>\n      )}\n      <div id=\"library-actions-container\">\n        {selectedItem && itemsData[selectedItem] && (\n          <>\n            <button className=\"ia-btn\" onClick={handleGenerateQuiz}>S'entraîner (Quiz IA)</button>\n            <button className=\"ia-btn success\" onClick={() => onGenerateCards(selectedItem, itemsData[selectedItem])}>Créer des cartes (IA)</button>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default LibraryView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}