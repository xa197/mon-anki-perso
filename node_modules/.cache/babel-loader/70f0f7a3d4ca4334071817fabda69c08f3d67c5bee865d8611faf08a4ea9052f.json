{"ast":null,"code":"import React,{useState}from'react';// On reçoit la nouvelle prop `onQuizComplete`\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function QuizView(_ref){let{navigateTo,questions,onQuizComplete}=_ref;const[currentQuestionIndex,setCurrentQuestionIndex]=useState(0);const[selectedAnswer,setSelectedAnswer]=useState(null);const[feedback,setFeedback]=useState('');const[score,setScore]=useState(0);const[quizFinished,setQuizFinished]=useState(false);// --- NOUVEL ÉTAT POUR L'HISTORIQUE DE LA SESSION ---\nconst[sessionResults,setSessionResults]=useState([]);if(!questions||questions.length===0){return/*#__PURE__*/_jsxs(\"div\",{id:\"quiz-view\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Erreur\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Aucune question n'a pu \\xEAtre g\\xE9n\\xE9r\\xE9e.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('library'),children:\"Retour \\xE0 la biblioth\\xE8que\"})]});}const currentQuestion=questions[currentQuestionIndex];const handleAnswerClick=answer=>{if(selectedAnswer)return;const isCorrect=answer===currentQuestion.answer;setSelectedAnswer(answer);if(isCorrect){setFeedback('Bonne réponse !');setScore(s=>s+1);}else{setFeedback(\"Mauvaise r\\xE9ponse. La bonne r\\xE9ponse \\xE9tait : \".concat(currentQuestion.answer));}// On enregistre le résultat de cette question\nsetSessionResults(prevResults=>[...prevResults,{question:currentQuestion.question,userAnswer:answer,isCorrect}]);};const handleNextQuestion=()=>{setSelectedAnswer(null);setFeedback('');if(currentQuestionIndex<questions.length-1){setCurrentQuestionIndex(currentQuestionIndex+1);}else{// Fin du quiz, on envoie les résultats au parent AVANT de changer de vue\nonQuizComplete(sessionResults);setQuizFinished(true);}};if(quizFinished){return/*#__PURE__*/_jsxs(\"div\",{id:\"quiz-results-view\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Quiz Termin\\xE9 !\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Votre score est de : \",score,\" / \",questions.length]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('library'),children:\"Retour \\xE0 la Biblioth\\xE8que\"})]});}return/*#__PURE__*/_jsx(\"div\",{id:\"quiz-view\"});}export default QuizView;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","QuizView","_ref","navigateTo","questions","onQuizComplete","currentQuestionIndex","setCurrentQuestionIndex","selectedAnswer","setSelectedAnswer","feedback","setFeedback","score","setScore","quizFinished","setQuizFinished","sessionResults","setSessionResults","length","id","children","onClick","currentQuestion","handleAnswerClick","answer","isCorrect","s","concat","prevResults","question","userAnswer","handleNextQuestion"],"sources":["/Users/xavier/mon-anki-perso/src/components/QuizView.js"],"sourcesContent":["import React, { useState } from 'react';\n\n// On reçoit la nouvelle prop `onQuizComplete`\nfunction QuizView({ navigateTo, questions, onQuizComplete }) {\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [selectedAnswer, setSelectedAnswer] = useState(null);\n  const [feedback, setFeedback] = useState('');\n  const [score, setScore] = useState(0);\n  const [quizFinished, setQuizFinished] = useState(false);\n  \n  // --- NOUVEL ÉTAT POUR L'HISTORIQUE DE LA SESSION ---\n  const [sessionResults, setSessionResults] = useState([]);\n\n  if (!questions || questions.length === 0) {\n    return (\n      <div id=\"quiz-view\">\n        <h2>Erreur</h2>\n        <p>Aucune question n'a pu être générée.</p>\n        <button onClick={() => navigateTo('library')}>Retour à la bibliothèque</button>\n      </div>\n    );\n  }\n\n  const currentQuestion = questions[currentQuestionIndex];\n\n  const handleAnswerClick = (answer) => {\n    if (selectedAnswer) return;\n\n    const isCorrect = answer === currentQuestion.answer;\n    setSelectedAnswer(answer);\n    \n    if (isCorrect) {\n      setFeedback('Bonne réponse !');\n      setScore(s => s + 1);\n    } else {\n      setFeedback(`Mauvaise réponse. La bonne réponse était : ${currentQuestion.answer}`);\n    }\n    \n    // On enregistre le résultat de cette question\n    setSessionResults(prevResults => [\n      ...prevResults,\n      { question: currentQuestion.question, userAnswer: answer, isCorrect }\n    ]);\n  };\n\n  const handleNextQuestion = () => {\n    setSelectedAnswer(null);\n    setFeedback('');\n    if (currentQuestionIndex < questions.length - 1) {\n      setCurrentQuestionIndex(currentQuestionIndex + 1);\n    } else {\n      // Fin du quiz, on envoie les résultats au parent AVANT de changer de vue\n      onQuizComplete(sessionResults);\n      setQuizFinished(true);\n    }\n  };\n\n  if (quizFinished) {\n    return (\n      <div id=\"quiz-results-view\">\n        <h2>Quiz Terminé !</h2>\n        <p>Votre score est de : {score} / {questions.length}</p>\n        <button onClick={() => navigateTo('library')}>Retour à la Bibliothèque</button>\n      </div>\n    );\n  }\n\n  return (\n    <div id=\"quiz-view\">\n      {/* ... (le reste du JSX ne change pas) ... */}\n    </div>\n  );\n}\n\nexport default QuizView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}