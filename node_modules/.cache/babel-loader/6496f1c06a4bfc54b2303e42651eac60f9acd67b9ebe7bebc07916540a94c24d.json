{"ast":null,"code":"import React,{useState,useEffect}from'react';import HomeView from'./components/HomeView';import LibraryView from'./components/LibraryView';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[currentView,setCurrentView]=useState('home');const[allCards,setAllCards]=useState([]);const[itemsData,setItemsData]=useState({});// Fonction pour charger les données, on peut l'appeler quand on veut\nconst loadInitialData=async()=>{try{const[cardsRes,itemsDataRes]=await Promise.all([fetch('/api/cards'),fetch('/api/items-data')]);if(!cardsRes.ok||!itemsDataRes.ok){throw new Error('Erreur serveur');}const cardsJson=await cardsRes.json();const itemsDataJson=await itemsDataRes.json();setAllCards(cardsJson);setItemsData(itemsDataJson);console.log(\"Données (re)chargées !\");}catch(e){console.error(\"Erreur chargement:\",e);}};useEffect(()=>{loadInitialData();// Chargement au démarrage\n},[]);// --- NOUVELLE FONCTION ---\n// Cette fonction sera passée aux composants enfants.\n// Elle sauvegarde les données PUIS recharge tout pour être à jour.\nconst handleSaveItemData=async(item,text)=>{try{const response=await fetch('/api/items-data',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({item,text})});if(!response.ok)throw new Error('Échec de la sauvegarde');await loadInitialData();// On recharge les données fraîches du serveur\nalert('Texte enregistré avec succès !');}catch(e){alert('Échec de la sauvegarde.');}};const renderCurrentView=()=>{switch(currentView){// ... (les autres vues ne changent pas)\ncase'review':return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Page de R\\xE9vision\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentView('home'),children:\"\\u2190 Accueil\"})]});case'manage':return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Page de Gestion\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentView('home'),children:\"\\u2190 Accueil\"})]});case'library':return/*#__PURE__*/_jsx(LibraryView,{navigateTo:setCurrentView,allCards:allCards,itemsData:itemsData});case'home':default:return/*#__PURE__*/_jsx(HomeView,{navigateTo:setCurrentView,allCards:allCards,itemsData:itemsData// ON PASSE LA NOUVELLE FONCTION EN PROP\n,onSaveItem:handleSaveItemData});}};return/*#__PURE__*/_jsx(\"div\",{className:\"AppContainer\",children:renderCurrentView()});}export default App;","map":{"version":3,"names":["React","useState","useEffect","HomeView","LibraryView","jsx","_jsx","jsxs","_jsxs","App","currentView","setCurrentView","allCards","setAllCards","itemsData","setItemsData","loadInitialData","cardsRes","itemsDataRes","Promise","all","fetch","ok","Error","cardsJson","json","itemsDataJson","console","log","e","error","handleSaveItemData","item","text","response","method","headers","body","JSON","stringify","alert","renderCurrentView","children","onClick","navigateTo","onSaveItem","className"],"sources":["/Users/xavier/mon-anki-perso/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport HomeView from './components/HomeView';\nimport LibraryView from './components/LibraryView';\n\nfunction App() {\n  const [currentView, setCurrentView] = useState('home');\n  const [allCards, setAllCards] = useState([]);\n  const [itemsData, setItemsData] = useState({});\n\n  // Fonction pour charger les données, on peut l'appeler quand on veut\n  const loadInitialData = async () => {\n    try {\n      const [cardsRes, itemsDataRes] = await Promise.all([ fetch('/api/cards'), fetch('/api/items-data') ]);\n      if (!cardsRes.ok || !itemsDataRes.ok) { throw new Error('Erreur serveur'); }\n      const cardsJson = await cardsRes.json();\n      const itemsDataJson = await itemsDataRes.json();\n      setAllCards(cardsJson);\n      setItemsData(itemsDataJson);\n      console.log(\"Données (re)chargées !\");\n    } catch (e) { console.error(\"Erreur chargement:\", e); }\n  };\n  \n  useEffect(() => {\n    loadInitialData(); // Chargement au démarrage\n  }, []);\n\n  // --- NOUVELLE FONCTION ---\n  // Cette fonction sera passée aux composants enfants.\n  // Elle sauvegarde les données PUIS recharge tout pour être à jour.\n  const handleSaveItemData = async (item, text) => {\n    try {\n      const response = await fetch('/api/items-data', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ item, text })\n      });\n      if (!response.ok) throw new Error('Échec de la sauvegarde');\n      \n      await loadInitialData(); // On recharge les données fraîches du serveur\n      alert('Texte enregistré avec succès !');\n\n    } catch (e) {\n      alert('Échec de la sauvegarde.');\n    }\n  };\n\n  const renderCurrentView = () => {\n    switch (currentView) {\n      // ... (les autres vues ne changent pas)\n      case 'review': return (<div><h2>Page de Révision</h2><button onClick={() => setCurrentView('home')}>← Accueil</button></div>);\n      case 'manage': return (<div><h2>Page de Gestion</h2><button onClick={() => setCurrentView('home')}>← Accueil</button></div>);\n      case 'library':\n        return (\n          <LibraryView \n            navigateTo={setCurrentView} \n            allCards={allCards}\n            itemsData={itemsData}\n          />\n        );\n      case 'home':\n      default:\n        return (\n          <HomeView \n            navigateTo={setCurrentView} \n            allCards={allCards}\n            itemsData={itemsData}\n            // ON PASSE LA NOUVELLE FONCTION EN PROP\n            onSaveItem={handleSaveItemData} \n          />\n        );\n    }\n  };\n\n  return ( <div className=\"AppContainer\">{renderCurrentView()}</div> );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}