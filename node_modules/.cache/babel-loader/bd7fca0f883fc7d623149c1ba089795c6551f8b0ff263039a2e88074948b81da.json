{"ast":null,"code":"import React,{useState,useEffect}from'react';import AtelierView from'./components/AtelierView';import QuizGeneratorView from'./components/QuizGeneratorView';import QuizView from'./components/QuizView';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){// --- ÉTATS ---\nconst[view,setView]=useState('atelier');const[allCards,setAllCards]=useState([]);const[itemsData,setItemsData]=useState({});const[isLoading,setIsLoading]=useState(false);const[quizQuestions,setQuizQuestions]=useState([]);// --- FONCTIONS DE DONNÉES (COMPLÈTES ET RESTAURÉES) ---\nconst loadData=async()=>{try{const[cardsRes,itemsDataRes]=await Promise.all([fetch('/api/cards'),fetch('/api/items-data')]);if(!cardsRes.ok||!itemsDataRes.ok){throw new Error('Erreur serveur');}setAllCards(await cardsRes.json());setItemsData(await itemsDataRes.json());}catch(e){console.error(\"Erreur chargement:\",e);}};useEffect(()=>{loadData();},[]);const handleSaveText=async(item,text)=>{if(!item)return alert('Veuillez sélectionner un item.');await fetch('/api/items-data',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({item,text})});alert('Texte enregistré !');await loadData();};const handleAddNewItem=async(newItemName,callback)=>{if(!newItemName.trim())return alert('Le nom ne peut pas être vide.');const response=await fetch('/api/add-item',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({newItemName:newItemName.trim()})});if(response.ok){if(callback)callback();await loadData();alert('Item ajouté !');}else{alert(await response.text());}};const handleLaunchQuiz=async(selectedItems,numQCM)=>{if(!selectedItems||selectedItems.length===0)return alert('Veuillez sélectionner au moins un item.');setIsLoading(true);const itemValues=selectedItems.map(item=>item.value);const textsToQuiz=itemValues.map(item=>itemsData[item]).filter(Boolean);try{const response=await fetch('/api/generate-questions',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({texts:textsToQuiz,numQCM})});const data=await response.json();if(data.error||!data.questions)throw new Error(data.error||'Pas de questions reçues');setQuizQuestions(data.questions);setView('quiz');}catch(e){alert(\"Impossible de générer le quiz.\");console.error(e);}finally{setIsLoading(false);}};// --- AFFICHAGE ---\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{id:\"loading-spinner\"});}if(view==='quiz'){return/*#__PURE__*/_jsx(QuizView,{questions:quizQuestions,onQuizEnd:()=>setView('quizGenerator')});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app-layout\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"main-header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mon Anki Perso\"}),/*#__PURE__*/_jsxs(\"nav\",{className:\"main-nav\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setView('atelier'),className:view==='atelier'?'active':'',children:\"Atelier\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setView('quizGenerator'),className:view==='quizGenerator'?'active':'',children:\"Quiz\"})]})]}),/*#__PURE__*/_jsxs(\"main\",{className:\"main-content\",children:[view==='atelier'&&/*#__PURE__*/_jsx(AtelierView,{navigateTo:setView,allCards:allCards,itemsData:itemsData,onSave:handleSaveText,onAddItem:handleAddNewItem}),view==='quizGenerator'&&/*#__PURE__*/_jsx(QuizGeneratorView,{navigateTo:setView,allCards:allCards,onLaunchQuiz:handleLaunchQuiz})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","AtelierView","QuizGeneratorView","QuizView","jsx","_jsx","jsxs","_jsxs","App","view","setView","allCards","setAllCards","itemsData","setItemsData","isLoading","setIsLoading","quizQuestions","setQuizQuestions","loadData","cardsRes","itemsDataRes","Promise","all","fetch","ok","Error","json","e","console","error","handleSaveText","item","text","alert","method","headers","body","JSON","stringify","handleAddNewItem","newItemName","callback","trim","response","handleLaunchQuiz","selectedItems","numQCM","length","itemValues","map","value","textsToQuiz","filter","Boolean","texts","data","questions","id","onQuizEnd","className","children","onClick","navigateTo","onSave","onAddItem","onLaunchQuiz"],"sources":["/Users/xavier/mon-anki-perso/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport AtelierView from './components/AtelierView';\nimport QuizGeneratorView from './components/QuizGeneratorView';\nimport QuizView from './components/QuizView';\n\nfunction App() {\n  // --- ÉTATS ---\n  const [view, setView] = useState('atelier');\n  const [allCards, setAllCards] = useState([]);\n  const [itemsData, setItemsData] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [quizQuestions, setQuizQuestions] = useState([]);\n\n  // --- FONCTIONS DE DONNÉES (COMPLÈTES ET RESTAURÉES) ---\n  const loadData = async () => {\n    try {\n      const [cardsRes, itemsDataRes] = await Promise.all([ fetch('/api/cards'), fetch('/api/items-data') ]);\n      if (!cardsRes.ok || !itemsDataRes.ok) { throw new Error('Erreur serveur'); }\n      setAllCards(await cardsRes.json());\n      setItemsData(await itemsDataRes.json());\n    } catch (e) { console.error(\"Erreur chargement:\", e); }\n  };\n  useEffect(() => { loadData(); }, []);\n\n  const handleSaveText = async (item, text) => {\n    if (!item) return alert('Veuillez sélectionner un item.');\n    await fetch('/api/items-data', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ item, text }) });\n    alert('Texte enregistré !');\n    await loadData();\n  };\n\n  const handleAddNewItem = async (newItemName, callback) => {\n    if (!newItemName.trim()) return alert('Le nom ne peut pas être vide.');\n    const response = await fetch('/api/add-item', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ newItemName: newItemName.trim() }) });\n    if (response.ok) {\n      if (callback) callback();\n      await loadData();\n      alert('Item ajouté !');\n    } else {\n      alert(await response.text());\n    }\n  };\n\n  const handleLaunchQuiz = async (selectedItems, numQCM) => {\n    if (!selectedItems || selectedItems.length === 0) return alert('Veuillez sélectionner au moins un item.');\n    setIsLoading(true);\n    const itemValues = selectedItems.map(item => item.value);\n    const textsToQuiz = itemValues.map(item => itemsData[item]).filter(Boolean);\n    try {\n        const response = await fetch('/api/generate-questions', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ texts: textsToQuiz, numQCM })\n        });\n        const data = await response.json();\n        if (data.error || !data.questions) throw new Error(data.error || 'Pas de questions reçues');\n        setQuizQuestions(data.questions);\n        setView('quiz');\n    } catch(e) {\n        alert(\"Impossible de générer le quiz.\");\n        console.error(e);\n    } finally {\n        setIsLoading(false);\n    }\n  };\n\n  // --- AFFICHAGE ---\n  if (isLoading) { return <div id=\"loading-spinner\"></div>; }\n  \n  if (view === 'quiz') {\n    return <QuizView questions={quizQuestions} onQuizEnd={() => setView('quizGenerator')} />;\n  }\n\n  return (\n    <div className=\"app-layout\">\n      <header className=\"main-header\">\n        <h1>Mon Anki Perso</h1>\n        <nav className=\"main-nav\">\n          <button onClick={() => setView('atelier')} className={view === 'atelier' ? 'active' : ''}>\n            Atelier\n          </button>\n          <button onClick={() => setView('quizGenerator')} className={view === 'quizGenerator' ? 'active' : ''}>\n            Quiz\n          </button>\n        </nav>\n      </header>\n      \n      <main className=\"main-content\">\n        {view === 'atelier' && (\n          <AtelierView \n            navigateTo={setView}\n            allCards={allCards} \n            itemsData={itemsData} \n            onSave={handleSaveText} \n            onAddItem={handleAddNewItem} \n          />\n        )}\n        {view === 'quizGenerator' && (\n          <QuizGeneratorView \n            navigateTo={setView}\n            allCards={allCards} \n            onLaunchQuiz={handleLaunchQuiz} \n          />\n        )}\n      </main>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}