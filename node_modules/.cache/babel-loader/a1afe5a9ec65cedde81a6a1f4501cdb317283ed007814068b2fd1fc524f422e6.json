{"ast":null,"code":"import React,{useState}from'react';// On reçoit `onStartQuiz` à la place de `onSetQuiz`\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function LibraryView(_ref){let{navigateTo,allCards,itemsData,onStartQuiz,onSetLoading,onGenerateCards}=_ref;const[selectedItem,setSelectedItem]=useState('');const[numQCM,setNumQCM]=useState(3);const[numQRU,setNumQRU]=useState(2);const sortedItems=Array.from(new Set(allCards.map(c=>c.deck).filter(Boolean))).sort((a,b)=>parseInt(a.split(':')[0],10)-parseInt(b.split(':')[0],10));sortedItems.unshift(\"500: Divers\");const handleGenerateQuiz=async()=>{if(!selectedItem||!itemsData[selectedItem])return;onSetLoading(true);try{const response=await fetch('/api/generate-questions',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:itemsData[selectedItem],numQCM,numQRU})});if(!response.ok)throw new Error('Erreur API');const quizData=await response.json();// ON APPELLE LA NOUVELLE FONCTION AVEC LES QUESTIONS ET L'ITEM\nonStartQuiz(quizData.questions,selectedItem);}catch(error){console.error(\"Erreur génération quiz:\",error);onStartQuiz([],selectedItem);// On démarre un quiz vide en cas d'erreur\n}finally{onSetLoading(false);}};const handleCreateCardsClick=()=>{/* ... (ne change pas) ... */};return/*#__PURE__*/_jsxs(\"div\",{id:\"library-view\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"library-header\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigateTo('home'),children:\"\\u2190 Accueil\"})}),/*#__PURE__*/_jsx(\"div\",{id:\"library-actions-container\",children:selectedItem&&itemsData[selectedItem]&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"ia-btn\",onClick:handleGenerateQuiz,children:\"S'entra\\xEEner (Quiz IA)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ia-btn success\",onClick:()=>onGenerateCards(selectedItem,itemsData[selectedItem]),children:\"Cr\\xE9er des cartes (IA)\"})]})})]});}export default LibraryView;","map":{"version":3,"names":["React","useState","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","LibraryView","_ref","navigateTo","allCards","itemsData","onStartQuiz","onSetLoading","onGenerateCards","selectedItem","setSelectedItem","numQCM","setNumQCM","numQRU","setNumQRU","sortedItems","Array","from","Set","map","c","deck","filter","Boolean","sort","a","b","parseInt","split","unshift","handleGenerateQuiz","response","fetch","method","headers","body","JSON","stringify","text","ok","Error","quizData","json","questions","error","console","handleCreateCardsClick","id","children","className","onClick"],"sources":["/Users/xavier/mon-anki-perso/src/components/LibraryView.js"],"sourcesContent":["import React, { useState } from 'react';\n\n// On reçoit `onStartQuiz` à la place de `onSetQuiz`\nfunction LibraryView({ navigateTo, allCards, itemsData, onStartQuiz, onSetLoading, onGenerateCards }) {\n  const [selectedItem, setSelectedItem] = useState('');\n  const [numQCM, setNumQCM] = useState(3);\n  const [numQRU, setNumQRU] = useState(2);\n\n  const sortedItems = Array.from(new Set(allCards.map(c => c.deck).filter(Boolean)))\n    .sort((a, b) => parseInt(a.split(':')[0], 10) - parseInt(b.split(':')[0], 10));\n  sortedItems.unshift(\"500: Divers\");\n\n  const handleGenerateQuiz = async () => {\n    if (!selectedItem || !itemsData[selectedItem]) return;\n    onSetLoading(true);\n    try {\n      const response = await fetch('/api/generate-questions', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ text: itemsData[selectedItem], numQCM, numQRU })\n      });\n      if (!response.ok) throw new Error('Erreur API');\n      const quizData = await response.json();\n      \n      // ON APPELLE LA NOUVELLE FONCTION AVEC LES QUESTIONS ET L'ITEM\n      onStartQuiz(quizData.questions, selectedItem);\n      \n    } catch (error) {\n      console.error(\"Erreur génération quiz:\", error);\n      onStartQuiz([], selectedItem); // On démarre un quiz vide en cas d'erreur\n    } finally {\n      onSetLoading(false);\n    }\n  };\n  \n  const handleCreateCardsClick = () => { /* ... (ne change pas) ... */ };\n\n  return (\n    <div id=\"library-view\">\n      {/* ... (tout le reste du JSX ne change pas) ... */}\n      <div className=\"library-header\">\n        <button onClick={() => navigateTo('home')}>← Accueil</button>\n        {/* ... */}\n      </div>\n      {/* ... */}\n      <div id=\"library-actions-container\">\n        {selectedItem && itemsData[selectedItem] && (\n          <>\n            <button className=\"ia-btn\" onClick={handleGenerateQuiz}>S'entraîner (Quiz IA)</button>\n            <button className=\"ia-btn success\" onClick={() => onGenerateCards(selectedItem, itemsData[selectedItem])}>Créer des cartes (IA)</button>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default LibraryView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}